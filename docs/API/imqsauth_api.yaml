openapi: 3.0.3
info:
  title: IMQS Auth API
  description: IMQS Authentication Service API - Provides comprehensive user authentication, authorization, and user management functionality
  version: 1.0.0
  contact:
    name: IMQS Software
    url: https://www.imqs.co.za
servers:
  - url: "{protocol}://{host}/{basePath}"
    variables:
      protocol:
        enum:
          - http
          - https
        default: https
      host:
        description: The hostname of the environment
        default: demo.imqs.co.za
      basePath:
        default: auth2
components:
  securitySchemes:
    basicAuth:
      type: http
      scheme: basic
      description: HTTP Basic Authentication using username/email and password
    sessionCookie:
      type: apiKey
      in: cookie
      name: session
      description: Session cookie set after successful login
    interServiceAuth:
      type: http
      scheme: bearer
      description: Inter-service authentication for trusted service-to-service communication
  schemas:
    Error:
      type: object
      properties:
        message:
          type: string
          description: Error message
      required:
        - message
    CheckResponse:
      type: object
      properties:
        UserId:
          type: integer
          format: int64
          description: Unique user identifier
        Identity:
          type: string
          description: User's login identity (email or username)
        Email:
          type: string
          format: email
          description: User's email address
        Username:
          type: string
          description: User's username
        Roles:
          type: array
          items:
            type: string
          description: List of role/permission IDs assigned to the user
        InternalUUID:
          type: string
          format: uuid
          description: Internal unique identifier for the user
      required:
        - UserId
        - Identity
        - Email
        - Roles
    UserObject:
      type: object
      properties:
        Email:
          type: string
          format: email
          description: User's email address
        UserId:
          type: integer
          format: int64
          description: Unique user identifier
        Username:
          type: string
          description: User's username
        Name:
          type: string
          description: User's first name
        Surname:
          type: string
          description: User's last name
        Mobile:
          type: string
          description: User's mobile phone number
        Telephone:
          type: string
          description: User's telephone number
        Remarks:
          type: string
          description: Additional remarks about the user
        Created:
          type: string
          format: date-time
          description: Timestamp when the user was created
        CreatedBy:
          type: string
          description: Name of user who created this user
        Modified:
          type: string
          format: date-time
          description: Timestamp when the user was last modified
        ModifiedBy:
          type: string
          description: Name of user who last modified this user
        Groups:
          type: array
          items:
            type: string
          description: List of group names the user belongs to
        AuthUserType:
          type: integer
          description: Type of authentication (0=Default, 1=LDAP, 2=MSAAD)
          enum: [0, 1, 2]
        Archived:
          type: boolean
          description: Whether the user is archived
        AccountLocked:
          type: boolean
          description: Whether the user account is locked
        InternalUUID:
          type: string
          format: uuid
          description: Internal unique identifier for the user
        LastLogin:
          type: string
          format: date-time
          description: Timestamp of user's last login
        EnabledDate:
          type: string
          format: date-time
          description: Timestamp when the user was enabled
        DisabledDate:
          type: string
          format: date-time
          description: Timestamp when the user was disabled
      required:
        - Email
        - UserId
        - AuthUserType
        - Archived
        - AccountLocked
    GroupResponse:
      type: object
      properties:
        Name:
          type: string
          description: Group name
        Roles:
          type: array
          items:
            type: string
          description: List of role/permission IDs assigned to the group
        ID:
          type: string
          description: Group identifier
      required:
        - Name
        - Roles
        - ID
    UserGroupsResponse:
      type: object
      properties:
        Email:
          type: string
          format: email
          description: User's email address
        UserName:
          type: string
          description: User's username
        Name:
          type: string
          description: User's first name
        Surname:
          type: string
          description: User's last name
        Groups:
          type: array
          items:
            type: string
          description: List of group names the user belongs to
      required:
        - Groups
    ExportUserGroups:
      type: object
      properties:
        Users:
          type: array
          items:
            type: object
            properties:
              ID:
                type: string
                description: "User identifier (email: xxx or username: xxx)"
              Groups:
                type: array
                items:
                  type: integer
                description: List of group IDs
            required:
              - ID
              - Groups
        Groups:
          type: array
          items:
            $ref: '#/components/schemas/RawAuthGroup'
        OverwriteGroups:
          type: boolean
          description: Whether to overwrite existing groups during import
      required:
        - Users
        - Groups
        - OverwriteGroups
    RawAuthGroup:
      type: object
      properties:
        Name:
          type: string
          description: Group name
        Roles:
          type: array
          items:
            type: string
          description: List of role/permission IDs
        ID:
          type: string
          description: Group identifier
      required:
        - Name
        - Roles
        - ID
    OAuthProvider:
      type: object
      properties:
        Name:
          type: string
          description: Internal provider name (e.g., "emerge")
        Type:
          type: string
          description: Provider type (e.g., "msaad")
        Title:
          type: string
          description: Display title for the provider (e.g., "eMerge")
        IsDefault:
          type: boolean
          description: Whether this is the default provider
      required:
        - Name
        - Type
        - Title
        - IsDefault
    LoginRequest:
      type: object
      properties:
        login_type:
          type: string
          description: Type of login (empty for normal, "msaad" for passthrough)
        client_id:
          type: string
          description: Client ID for passthrough authentication
    PermissionTable:
      type: object
      additionalProperties:
        type: string
      description: Mapping of permission IDs to permission names
    PingResponse:
      type: object
      properties:
        Timestamp:
          type: integer
          format: int64
          description: Unix timestamp
      required:
        - Timestamp
    HostnameResponse:
      type: object
      properties:
        Hostname:
          type: string
          description: Service hostname URL
      required:
        - Hostname
  responses:
    BadRequest:
      description: Bad Request
      content:
        text/plain:
          schema:
            type: string
            example: Error message
    Unauthorized:
      description: Unauthorized
      content:
        text/plain:
          schema:
            type: string
            example: No authorization information
    Forbidden:
      description: Forbidden
      content:
        text/plain:
          schema:
            type: string
            example: You are not an administrator
    NotFound:
      description: Not Found
      content:
        text/plain:
          schema:
            type: string
            example: Resource not found
    MethodNotAllowed:
      description: Method Not Allowed
      content:
        text/plain:
          schema:
            type: string
            example: Method not allowed
    NotAcceptable:
      description: Not Acceptable
      content:
        text/plain:
          schema:
            type: string
            example: Error message
    InternalServerError:
      description: Internal Server Error
      content:
        text/plain:
          schema:
            type: string
            example: Error message
    ServiceUnavailable:
      description: Service Unavailable
      content:
        text/plain:
          schema:
            type: string
            example: Error message
security:
  - basicAuth: []
paths:
  /hello:
    get:
      summary: Hello
      description: Simple health check endpoint that returns a greeting
      security: []
      responses:
        '200':
          description: OK
          content:
            text/plain:
              schema:
                type: string
                example: Hello!
  /ping:
    get:
      summary: Ping
      description: Service health check that returns current timestamp
      security: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PingResponse'
  /hostname:
    get:
      summary: Get Hostname
      description: Returns the configured hostname URL for this service
      security: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HostnameResponse'
  /login:
    post:
      summary: User Login
      description: Authenticate user and create session. Supports normal IMQS login and MSAAD passthrough authentication.
      security:
        - basicAuth: []
      requestBody:
        required: false
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: Login successful
          headers:
            Set-Cookie:
              schema:
                type: string
                example: session=asdflkj2rsdfDFF3sdfsdf23; Path=/; Expires=Tue, 11 Mar 2025 08:25:45 GMT
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CheckResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
  /logout:
    post:
      summary: User Logout
      description: Invalidate user session and logout
      security:
        - sessionCookie: []
        - basicAuth: []
      responses:
        '200':
          description: Logout successful
          content:
            text/plain:
              schema:
                type: string
                example: ""
        '401':
          $ref: '#/components/responses/Unauthorized'
  /check:
    get:
      summary: Check Authentication
      description: Verify current session and return user information with permissions
      security:
        - sessionCookie: []
        - basicAuth: []
      responses:
        '200':
          description: Authentication valid
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CheckResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          description: Account disabled
          content:
            text/plain:
              schema:
                type: string
                example: Account disabled
        '500':
          $ref: '#/components/responses/InternalServerError'
  /create_user:
    put:
      summary: Create User
      description: Create a new user account (admin rights required)
      security:
        - basicAuth: []
        - sessionCookie: []
      parameters:
        - name: email
          in: query
          required: true
          schema:
            type: string
            format: email
          description: User's email address
        - name: username
          in: query
          required: false
          schema:
            type: string
          description: User's username (if not provided, email is used)
        - name: firstname
          in: query
          required: true
          schema:
            type: string
          description: User's first name
        - name: lastname
          in: query
          required: true
          schema:
            type: string
          description: User's last name
        - name: mobilenumber
          in: query
          required: false
          schema:
            type: string
          description: User's mobile phone number
        - name: telephonenumber
          in: query
          required: false
          schema:
            type: string
          description: User's telephone number
        - name: remarks
          in: query
          required: false
          schema:
            type: string
          description: Additional remarks about the user
        - name: password
          in: query
          required: false
          schema:
            type: string
          description: User's password (if not provided, reset email is sent)
        - name: uuid
          in: query
          required: false
          schema:
            type: string
            format: uuid
          description: Internal UUID for the user
      responses:
        '200':
          description: User created successfully
          content:
            text/plain:
              schema:
                type: string
                example: Created identity 'user@example.com'
        '403':
          $ref: '#/components/responses/Forbidden'
  /update_user:
    post:
      summary: Update User
      description: Update an existing user's information (admin rights required)
      security:
        - basicAuth: []
        - sessionCookie: []
      parameters:
        - name: userid
          in: query
          required: true
          schema:
            type: integer
            format: int64
          description: User ID to update
        - name: email
          in: query
          required: true
          schema:
            type: string
            format: email
          description: User's email address
        - name: username
          in: query
          required: false
          schema:
            type: string
          description: User's username
        - name: firstname
          in: query
          required: true
          schema:
            type: string
          description: User's first name
        - name: lastname
          in: query
          required: true
          schema:
            type: string
          description: User's last name
        - name: mobilenumber
          in: query
          required: false
          schema:
            type: string
          description: User's mobile phone number
        - name: telephonenumber
          in: query
          required: false
          schema:
            type: string
          description: User's telephone number
        - name: remarks
          in: query
          required: false
          schema:
            type: string
          description: Additional remarks about the user
        - name: authusertype
          in: query
          required: true
          schema:
            type: string
            enum: [DEFAULT, LDAP]
          description: Authentication user type
      responses:
        '200':
          description: User updated successfully
          content:
            text/plain:
              schema:
                type: string
                example: Updated user '123'
        '400':
          $ref: '#/components/responses/BadRequest'
        '403':
          $ref: '#/components/responses/Forbidden'
  /unlock_user:
    post:
      summary: Unlock User
      description: Unlock a locked user account (admin rights required)
      security:
        - basicAuth: []
        - sessionCookie: []
      parameters:
        - name: userid
          in: query
          required: true
          schema:
            type: integer
            format: int64
          description: User ID to unlock
        - name: username
          in: query
          required: false
          schema:
            type: string
          description: Username for logging purposes
      responses:
        '200':
          description: User unlocked successfully
          content:
            text/plain:
              schema:
                type: string
                example: Unlocked user '123'
        '400':
          $ref: '#/components/responses/BadRequest'
        '403':
          $ref: '#/components/responses/Forbidden'
  /archive_user:
    post:
      summary: Archive User
      description: Archive (soft delete) a user account (admin rights required)
      security:
        - basicAuth: []
        - sessionCookie: []
      parameters:
        - name: userid
          in: query
          required: true
          schema:
            type: integer
            format: int64
          description: User ID to archive
      responses:
        '200':
          description: User archived successfully
          content:
            text/plain:
              schema:
                type: string
                example: Archived user '123'
        '403':
          $ref: '#/components/responses/Forbidden'
  /create_group:
    put:
      summary: Create Group
      description: Create a new user group (admin rights required)
      security:
        - basicAuth: []
        - sessionCookie: []
      parameters:
        - name: groupname
          in: query
          required: true
          schema:
            type: string
          description: Name of the group to create
      responses:
        '200':
          description: Group created successfully
        '400':
          description: Bad Request
          content:
            text/plain:
              schema:
                type: string
                example: "Error creating group (groupname): error details"
        '403':
          $ref: '#/components/responses/Forbidden'
        '406':
          $ref: '#/components/responses/NotAcceptable'
  /update_group:
    post:
      summary: Update Group
      description: Update an existing group's name (admin rights required)
      security:
        - basicAuth: []
        - sessionCookie: []
      parameters:
        - name: name
          in: query
          required: true
          schema:
            type: string
          description: Current group name
        - name: newname
          in: query
          required: true
          schema:
            type: string
          description: New group name
      responses:
        '200':
          description: Group updated successfully
        '400':
          $ref: '#/components/responses/BadRequest'
        '403':
          $ref: '#/components/responses/Forbidden'
        '406':
          $ref: '#/components/responses/NotAcceptable'
  /delete_group:
    put:
      summary: Delete Group
      description: Delete a user group (admin rights required). Cannot delete 'admin' or 'enabled' groups.
      security:
        - basicAuth: []
        - sessionCookie: []
      parameters:
        - name: groupname
          in: query
          required: true
          schema:
            type: string
          description: Name of the group to delete
      responses:
        '200':
          description: Group deleted successfully
        '400':
          description: Bad Request
          content:
            text/plain:
              schema:
                type: string
                example: "Error deleting group (groupname): error details"
        '403':
          $ref: '#/components/responses/Forbidden'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '406':
          $ref: '#/components/responses/NotAcceptable'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /rename_user:
    post:
      summary: Rename User
      description: Rename a user's identity. Requires admin rights or user must authenticate themselves.
      security:
        - basicAuth: []
        - sessionCookie: []
      parameters:
        - name: old
          in: query
          required: true
          schema:
            type: string
          description: Current user identity (email or username)
        - name: new
          in: query
          required: true
          schema:
            type: string
          description: New user identity (email or username)
      responses:
        '200':
          description: User renamed successfully
          content:
            text/plain:
              schema:
                type: string
                example: Renamed 'old@example.com' to 'new@example.com'
        '400':
          $ref: '#/components/responses/BadRequest'
        '403':
          $ref: '#/components/responses/Forbidden'
  /set_group_roles:
    put:
      summary: Set Group Roles
      description: Set the permissions/roles for a specific group (admin rights required)
      security:
        - basicAuth: []
        - sessionCookie: []
      parameters:
        - name: groupname
          in: query
          required: true
          schema:
            type: string
          description: Name of the group
        - name: roles
          in: query
          required: true
          schema:
            type: string
          description: Comma-separated list of role/permission IDs
          example: "23,45,99"
      responses:
        '200':
          description: Group roles set successfully
          content:
            text/plain:
              schema:
                type: string
                example: "Group: groupname roles updated: Added: admin Removed: none"
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '406':
          $ref: '#/components/responses/NotAcceptable'
  /set_user_groups:
    post:
      summary: Set User Groups
      description: Set the groups a user belongs to (admin rights required)
      security:
        - basicAuth: []
        - sessionCookie: []
      parameters:
        - name: userid
          in: query
          required: true
          schema:
            type: integer
            format: int64
          description: User ID
        - name: groups
          in: query
          required: true
          schema:
            type: string
          description: Comma-separated list of group names
          example: "Assets,enabled,DevelopmentControl - Admin"
      responses:
        '200':
          description: User groups set successfully
          content:
            text/plain:
              schema:
                type: string
                example: "'123' groups set to (Assets,enabled)"
        '403':
          $ref: '#/components/responses/Forbidden'
  /set_password:
    post:
      summary: Set Password
      description: Set a user's password. Admin can set any user's password, users can set their own password.
      security:
        - basicAuth: []
        - sessionCookie: []
      parameters:
        - name: userid
          in: query
          required: true
          schema:
            type: integer
            format: int64
          description: User ID whose password to set
        - name: password
          in: query
          required: false
          schema:
            type: string
          description: New password (deprecated - use X-NewPassword header instead)
        - name: X-NewPassword
          in: header
          required: false
          schema:
            type: string
          description: New password (preferred method)
      responses:
        '200':
          description: Password changed successfully
          content:
            text/plain:
              schema:
                type: string
                example: Password changed
        '400':
          $ref: '#/components/responses/BadRequest'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /update_password:
    post:
      summary: Update Password
      description: Update a user's password by providing the old password for verification
      security: []
      parameters:
        - name: email
          in: query
          required: true
          schema:
            type: string
            format: email
          description: User's email/identity
        - name: X-OldPassword
          in: header
          required: true
          schema:
            type: string
          description: Current password for verification
        - name: X-NewPassword
          in: header
          required: true
          schema:
            type: string
          description: New password
      responses:
        '200':
          description: Password changed successfully
          content:
            text/plain:
              schema:
                type: string
                example: Password changed
        '400':
          $ref: '#/components/responses/BadRequest'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /check_password:
    post:
      summary: Check Password
      description: Verify a user's password without creating a session
      security:
        - basicAuth: []
      responses:
        '200':
          description: Password verified successfully
          content:
            text/plain:
              schema:
                type: string
                example: Password verified
        '400':
          $ref: '#/components/responses/BadRequest'
        '403':
          $ref: '#/components/responses/Forbidden'
  /reset_password_start:
    post:
      summary: Reset Password Start
      description: Initiate password reset process by sending reset email
      security: []
      parameters:
        - name: userid
          in: query
          required: false
          schema:
            type: integer
            format: int64
          description: User ID (either userid or email must be specified)
        - name: email
          in: query
          required: false
          schema:
            type: string
            format: email
          description: User's email (either userid or email must be specified)
      responses:
        '200':
          description: Password reset email sent successfully
        '400':
          $ref: '#/components/responses/BadRequest'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalServerError'
        '503':
          $ref: '#/components/responses/ServiceUnavailable'
  /reset_password_finish:
    post:
      summary: Reset Password Finish
      description: Complete password reset using reset token
      security: []
      parameters:
        - name: userid
          in: query
          required: true
          schema:
            type: integer
            format: int64
          description: User ID
        - name: X-ResetToken
          in: header
          required: true
          schema:
            type: string
          description: Password reset token from email
        - name: X-NewPassword
          in: header
          required: true
          schema:
            type: string
          description: New password
      responses:
        '200':
          description: Password reset successfully
          content:
            text/plain:
              schema:
                type: string
                example: Password reset
        '400':
          $ref: '#/components/responses/BadRequest'
        '403':
          $ref: '#/components/responses/Forbidden'
  /users:
    get:
      summary: Get Users
      description: Get list of users with basic information and group membership
      security:
        - basicAuth: []
        - sessionCookie: []
      responses:
        '200':
          description: Users retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserGroupsResponse'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /userobjects:
    get:
      summary: Get User Objects
      description: Get detailed user objects with comprehensive information (admin rights required)
      security:
        - basicAuth: []
        - sessionCookie: []
      parameters:
        - name: archived
          in: query
          required: false
          schema:
            type: boolean
          description: Include archived users in results
        - name: permission
          in: query
          required: false
          schema:
            type: integer
            format: int16
          description: Filter users by specific permission ID
      responses:
        '200':
          description: User objects retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserObject'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /userobject:
    get:
      summary: Get User Object
      description: Get detailed information for a specific user (admin rights required)
      security:
        - basicAuth: []
        - sessionCookie: []
      parameters:
        - name: userid
          in: query
          required: false
          schema:
            type: integer
            format: int64
          description: User ID (either userid or identity must be specified)
        - name: identity
          in: query
          required: false
          schema:
            type: string
          description: User identity/email (either userid or identity must be specified)
      responses:
        '200':
          description: User object retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserObject'
        '400':
          $ref: '#/components/responses/BadRequest'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /groups:
    get:
      summary: Get Groups
      description: Get list of all user groups with their permissions
      security: []
      responses:
        '200':
          description: Groups retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/GroupResponse'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /exportgroups:
    get:
      summary: Export User Groups
      description: Export user group memberships and group definitions (admin rights required)
      security:
        - basicAuth: []
        - sessionCookie: []
      responses:
        '200':
          description: User groups exported successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExportUserGroups'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /importgroups:
    post:
      summary: Import User Groups
      description: Import user group memberships and group definitions (inter-service authentication required)
      security:
        - interServiceAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExportUserGroups'
      responses:
        '200':
          description: User groups imported successfully
        '400':
          $ref: '#/components/responses/BadRequest'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /hasactivedirectory:
    get:
      summary: Has Active Directory
      description: Check if Active Directory/LDAP integration is configured
      security: []
      responses:
        '200':
          description: Active Directory status
          content:
            text/plain:
              schema:
                type: string
                enum: ['0', '1']
                example: '1'
                description: "'1' if LDAP is configured, '0' otherwise"
  /groups_perm_names:
    get:
      summary: Get Groups Permission Names
      description: Get mapping of permission IDs to human-readable permission names (admin rights required)
      security:
        - basicAuth: []
        - sessionCookie: []
      responses:
        '200':
          description: Permission names retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionTable'
        '403':
          $ref: '#/components/responses/Forbidden'
  /dynamic_permissions:
    get:
      summary: Get Dynamic Permissions
      description: Get client-specific dynamic permissions configuration
      security: []
      responses:
        '200':
          description: Dynamic permissions retrieved successfully
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true
                description: Dynamic permissions configuration object
        '500':
          $ref: '#/components/responses/InternalServerError'
  /oauth/providers:
    get:
      summary: Get OAuth Providers
      description: Get list of available OAuth authentication providers
      security: []
      responses:
        '200':
          description: OAuth providers retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/OAuthProvider'
  /oauth/start:
    get:
      summary: Start OAuth Flow
      description: Initiate OAuth authentication flow with specified provider
      parameters:
        - name: provider
          in: query
          required: false
          schema:
            type: string
          description: OAuth provider name (uses default if not specified)
        - name: redirect_uri
          in: query
          required: false
          schema:
            type: string
            format: uri
          description: Redirect URI after authentication
      security: []
      responses:
        '302':
          description: Redirect to OAuth provider
          headers:
            Location:
              schema:
                type: string
                format: uri
              description: OAuth provider authorization URL
        '400':
          $ref: '#/components/responses/BadRequest'
    post:
      summary: Start OAuth Flow (POST)
      description: Initiate OAuth authentication flow with specified provider (POST variant)
      requestBody:
        required: false
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                provider:
                  type: string
                  description: OAuth provider name
                redirect_uri:
                  type: string
                  format: uri
                  description: Redirect URI after authentication
      security: []
      responses:
        '302':
          description: Redirect to OAuth provider
          headers:
            Location:
              schema:
                type: string
                format: uri
              description: OAuth provider authorization URL
        '400':
          $ref: '#/components/responses/BadRequest'
  /oauth/finish:
    get:
      summary: Finish OAuth Flow
      description: Complete OAuth authentication flow and create user session
      parameters:
        - name: code
          in: query
          required: false
          schema:
            type: string
          description: OAuth authorization code
        - name: state
          in: query
          required: false
          schema:
            type: string
          description: OAuth state parameter
        - name: error
          in: query
          required: false
          schema:
            type: string
          description: OAuth error parameter
      security: []
      responses:
        '302':
          description: Redirect to application after successful authentication
          headers:
            Location:
              schema:
                type: string
                format: uri
              description: Application redirect URL
            Set-Cookie:
              schema:
                type: string
              description: Session cookie set after successful login
        '400':
          $ref: '#/components/responses/BadRequest'
        '403':
          $ref: '#/components/responses/Forbidden'